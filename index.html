<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Would You Rather</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #ff9933, #ffffff, #138808);
      background-size: 300% 300%;
      animation: gradientBG 12s ease infinite;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .poll-container {
      position: relative;
      background: rgba(255, 255, 255, 0.9);
      padding: 4rem 2rem 2rem;
      border-radius: 20px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
      max-width: 500px;
      width: 90%;
      text-align: center;
      overflow: hidden;
    }

    .poll-container::before {
      content: "";
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 100px;
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Ashoka_Chakra.svg/768px-Ashoka_Chakra.svg.png');
      background-repeat: no-repeat;
      background-size: contain;
      background-position: center;
      opacity: 0.1;
      z-index: 0;
    }

    h2 {
      margin-bottom: 1.5rem;
      color: #1a237e;
      position: relative;
      z-index: 1;
    }

    .option-btn {
      position: relative;
      overflow: hidden;
      background: #1a237e;
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: bold;
      font-size: 1rem;
      padding: 15px;
      margin: 10px 0;
      width: 100%;
      cursor: pointer;
      transition: background 0.3s;
      z-index: 1;
    }

    .option-btn .fill {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0%;
      background: #f9a825;
      z-index: 0;
      transition: width 0.6s ease-in-out;
    }

    .option-btn .fill.green {
      background: #43a047;
    }

    .option-btn span {
      position: relative;
      z-index: 1;
    }

    .option-btn:hover {
      background: #0d1b66;
    }

    .next-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      background: #e65100;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
      z-index: 1;
      position: relative;
    }

    .next-btn:hover {
      background: #bf360c;
    }
  </style>
</head>
<body>

<div class="poll-container">
  <h2 id="question">Would you rather...</h2>
  <button class="option-btn" id="option1"><div class="fill"></div><span></span></button>
  <button class="option-btn" id="option2"><div class="fill green"></div><span></span></button>
  <button class="next-btn" onclick="nextQuestion()">Next Question</button>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBKrkkCW0IhK574TAduZ4G-1tP-UXxSHdo",
    authDomain: "nss-wouldyourather.firebaseapp.com",
    databaseURL: "https://nss-wouldyourather-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "nss-wouldyourather",
    storageBucket: "nss-wouldyourather.appspot.com",
    messagingSenderId: "1049319090770",
    appId: "1:1049319090770:web:2dd03f8b34f052c416cd8b",
    measurementId: "G-K6BFLVN9E2"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const questions = [
    { id: 'q1', text: "Be invisible or be able to fly?", options: ["Be invisible", "Fly"] },
    { id: 'q2', text: "Live in the mountains or on a beach?", options: ["Mountains", "Beach"] },
    { id: 'q3', text: "Time travel to the past or future?", options: ["Past", "Future"] },
    { id: 'q4', text: "Have super strength or super intelligence?", options: ["Strength", "Intelligence"] }
  ];

  let currentIndex = 0;
  const questionEl = document.getElementById("question");
  const option1Btn = document.getElementById("option1");
  const option2Btn = document.getElementById("option2");

  function loadQuestion() {
    const current = questions[currentIndex];
    questionEl.innerText = current.text;

    option1Btn.querySelector("span").innerText = current.options[0];
    option2Btn.querySelector("span").innerText = current.options[1];
    option1Btn.querySelector(".fill").style.width = "0%";
    option2Btn.querySelector(".fill").style.width = "0%";

    option1Btn.disabled = false;
    option2Btn.disabled = false;
    document.querySelector('.next-btn').disabled = true;

    const votePath = `votes/${current.id}`;
    db.ref(votePath).on('value', snapshot => {
      const votes = snapshot.val() || [0, 0];
      if (votes[0] + votes[1] > 0) {
        showResults(votes);
        document.querySelector('.next-btn').disabled = false;
      }
    });
  }

  function vote(optionIndex) {
    const current = questions[currentIndex];
    const votePath = `votes/${current.id}`;

    if (localStorage.getItem(current.id)) {
      alert("You've already voted on this question.");
      return;
    }
    localStorage.setItem(current.id, true);

    db.ref(votePath).once('value', snapshot => {
      const votes = snapshot.val() || [0, 0];
      votes[optionIndex]++;
      db.ref(votePath).set(votes);
      showResults(votes);
    });

    option1Btn.disabled = true;
    option2Btn.disabled = true;
  }

  function showResults(votes) {
    const total = votes[0] + votes[1];
    const p1 = total ? ((votes[0] / total) * 100).toFixed(1) : 0;
    const p2 = total ? ((votes[1] / total) * 100).toFixed(1) : 0;

    option1Btn.querySelector(".fill").style.width = `${p1}%`;
    option2Btn.querySelector(".fill").style.width = `${p2}%`;

    option1Btn.querySelector("span").innerText = `${questions[currentIndex].options[0]}: ${votes[0]} vote(s) (${p1}%)`;
    option2Btn.querySelector("span").innerText = `${questions[currentIndex].options[1]}: ${votes[1]} vote(s) (${p2}%)`;
  }

  function nextQuestion() {
  currentIndex++;
  if (currentIndex >= questions.length) {
    document.querySelector('.poll-container').innerHTML = `
      <h2>Thank you for participating!</h2>
      <p>Jai Hind ðŸ‡®ðŸ‡³</p>
    `;
  } else {
    loadQuestion();
  }
}


  option1Btn.addEventListener("click", () => vote(0));
  option2Btn.addEventListener("click", () => vote(1));

  loadQuestion();
</script>
</body>
</html>
